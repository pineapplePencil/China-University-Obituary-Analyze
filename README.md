# 中国高校讣告数据分析

## 项目简介
为中国高校的讣告数据提供标准化的简易分析与绘图代码，这可以使大家不必费力写一些基础的数据可视化相关代码。

## 数据格式
标准化数据文件须为.csv格式，数据表中分四列，分别为：Name, Time, Age, Place；分别表示：姓名、去世日期、去世时年龄、去世地点。

具体可参考我们给出的示例数据文件[university_1.csv](university_1.csv)，该示例数据来自真实的中国华北地区某所高校2019至2022年全部的公开发布的讣告信息，出于尊重与隐私保护的考虑，示例数据仅展示去世日期(Time)与年龄(Age)，而略去姓名(Name)与去世地点(Place)。

使用本仓库的数据绘图代码时，须参照上述格式自行采集相关数据，并确保自己的数据文件格式与我们给出的示例数据文件[university_1.csv](university_1.csv)的格式相同，否则代码会报错。

去世日期(Time)格式如: 2022/12/31，表示2022年12月31日。

年龄(Age)格式为大于0的正整数。

## 对[university_1.csv](university_1.csv)数据中2019年至2022年去世地点的补充说明

考虑到可能有人质疑[university_1.csv](university_1.csv)中去世地点的问题，因此虽然略去了去世地点数据，但是在这里公布去世地点比例如下：

**2019至2022年全部数据共351条**，**其中去世于该学校所在城市的记录有309条(88.03%)**，去世于国内其他城市(含港澳台地区)的记录有10条(2.85%)，去世于国外的记录有15条(4.27%)，讣告中未披露去世地点的记录有17条(4.84%)。

**2022年12月全部数据共39条**，**其中去世于该学校所在城市的记录有38条(97.44%)**，去世于国内其他城市(含港澳台地区)的记录有1条(2.56%)，无去世于国外的记录，无未披露去世地点记录。

## 使用方法
### 1. 初始化数据
```python
from analyze import Analyzer

analyzer = Analyzer(csv_file_path='university_1.csv', language='zh-hans')
```

**csv_file_path**: 你的讣告数据csv文件的路径

**language**: 语言设定，默认为简体中文'zh-hans'，目前可选语言还有英文'en'。语言会影响最终绘制的图像中的文字的语言，如图像标题、坐标轴文字等。

语言翻译内容在[language_translation.py](language_translation.py)中。

### 2. 绘制不同年份下每个月份讣告数量对比图
```python
analyzer.plot_obituary_number_data_group_by_month(year_list=['2019', '2020', '2021', '2022'])
```
**year_list**: 指定讣告数据文件涵盖的年份，这必须与你自己的数据相匹配。

根据示例数据文件[university_1.csv](university_1.csv)得到的结果图绘制如下：
![](group_by_month_zhhans.png?raw=true "某高校不同年份下每月讣告数量图")

### 3. 绘制不同年份下按月累加的讣告数量对比图
```python
analyzer.plot_cumulative_obituary_number_by_month(year_list=['2019', '2020', '2021', '2022'])
```
**year_list**: 指定讣告数据文件涵盖的年份，这必须与你自己的数据相匹配。

根据示例数据文件[university_1.csv](university_1.csv)得到的结果图绘制如下：
![](cum_by_month_zhhans.png?raw=true "某高校不同年份下按月累加的讣告数量图")

### 4. 绘制按日累加的讣告数量曲线
```python
analyzer.plot_cumulative_obituary_number_by_date(start_date='2019-01-01', end_date='2022-12-31')
```
**start_date**: 指定起始日期，日期格式如'2019-01-01'，表示起始日期为2019年1月1日。起始日期必须不早于你的数据文件中所有记录的最早日期，且早于终止日期end_date，否则抛出AssertionError。

**end_date**: 指定终止日期，日期格式如'2022-12-31'，表示终止日期为2022年12月31日。终止日期必须不晚于你的数据文件中所有记录的最晚日期，且晚于起始日期start_date，否则抛出AssertionError。

根据示例数据文件[university_1.csv](university_1.csv)得到的结果图绘制如下（选取了两个不同的时间范围）：

**第1张图时间范围：2019年1月1日至2022年12月31日**
![](cum_by_day_zhhans_1.png?raw=true "某高校按日累加的讣告数量图")

**第2张图时间范围：2022年6月1日至2022年12月31日**
![](cum_by_day_zhhans_2.png?raw=true "某高校按日累加的讣告数量图")


### 5. 绘制去世年龄频率分布直方图
```python
compare_group_date_range = [['2019-01-01', '2019-01-31'], ['2019-11-01', '2019-12-31'], ['2020-01-01', '2020-01-31'], ['2020-11-01', '2020-12-31'], ['2021-01-01', '2021-01-31'], ['2021-11-01', '2021-12-31'], ['2022-11-01', '2022-11-30']]
analyzer.plot_age_histogram(start_date='2022-12-01', end_date='2022-12-31', compare_group_date_range=compare_group_date_range)
```
**start_date**: 指定待分析时间区间的起始日期，日期格式如'2019-01-01'，表示起始日期为2019年1月1日。起始日期必须不早于你的数据文件中所有记录的最早日期，且早于终止日期end_date，否则抛出AssertionError。

**end_date**: 指定待分析时间区间的终止日期，日期格式如'2022-12-31'，表示终止日期为2022年12月31日。终止日期必须不晚于你的数据文件中所有记录的最晚日期，且晚于起始日期start_date，否则抛出AssertionError。

**compare_group_date_range**: 指定对照组时间区间，compare_group_date_range是一个list，其中每个元素也是一个list(下称子区间list)，每个子区间list指定一个对照组子时间区间，可以指定多个子时间区间，并且这些子时间区间不要求是连续的。格式示例如：[[start_1, end_1], [start_2, end_2]]。注意，每个子区间均需满足时间先后关系，即每个时间不能超出你的数据文件的时间范围，且每个子区间的起始时间必须早于结束时间，否则抛出AssertionError。

**对示例代码的解释**: 示例代码中，选取2022-12-01到2022-12-31的数据为待分析数据，同时选取2019、2020、2021这三年的1月、11月、12月以及2022年的1月与11月(这些日期范围与待分析的12月同属华北地区冬季，具有对照意义)的数据作为对照组，在同一张图中分别绘制待分析区间与对照组区间的去世年龄频率分布直方图。

根据示例数据文件[university_1.csv](university_1.csv)得到的结果图绘制如下：
![](age_histogram_zhhans.png?raw=true "特定时间区间内去世年龄的频率分布直方图")


## 建议与贡献
欢迎在Issues中提出任何反馈与建议，比如你希望对讣告数据进行哪些分析与可视化，我们会尽力与尽快实现。


## 免责声明
本仓库全部内容旨在学习与探究Python数据分析与数据可视化内容，仅供学习与教育使用。不包含任何涉密与敏感信息。全部代码均为数据分析、数据可视化相关的开源代码，不包含任何恶意程序与恶意代码。不提供任何数据采集相关的代码与工具。对使用本项目造成的任何后果不承担责任。
